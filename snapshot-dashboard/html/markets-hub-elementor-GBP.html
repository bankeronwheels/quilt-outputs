<!-- BoW Markets Hub ‚Äì Modern Dashboard --><html><head><style>
  :root {
    --bow-bg: #f7f3ee;
    --bow-card: #fdf7f0;
    --bow-border: #e5ded1;
    --bow-border-soft: #efe5d7;
    --bow-accent: #8b1e3f;
    --bow-accent-soft: #c73e5d;
    --bow-text: #111827;
    --bow-muted: #6b7280;
  }

  .bow-markets-hub {
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    color: var(--bow-text);
    max-width: 1160px;
    margin: 0 auto;
    padding: 1.75rem 1.5rem 2rem;
    background: #fff;
    border-radius: 24px;
    border: 1px solid #f2ebe1;
    box-shadow: 0 18px 40px rgba(15, 23, 42, 0.06);
    box-sizing: border-box;
  }

  .bow-mh-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 1rem;
    margin-bottom: 1.2rem;
  }

  .bow-mh-header h2 {
    margin: 0 0 0.35rem;
    font-size: 1.5rem;
    letter-spacing: 0.02em;
  }

  .bow-mh-subtitle {
    margin: 0;
    font-size: 0.9rem;
    color: var(--bow-muted);
  }

  /* TOP BAR ------------------------------------------------------------ */

  .bow-mh-topbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1.25rem;
    padding: 0.7rem 1rem;
    border-radius: 999px;
    background: linear-gradient(90deg, rgba(139, 30, 63, 0.04), rgba(139, 30, 63, 0.02));
    border: 1px solid rgba(139, 30, 63, 0.09);
    flex-wrap: wrap;
  }

  .bow-mh-topbar-group {
    display: flex;
    align-items: center;
    gap: 0.8rem;
    flex-wrap: wrap;
  }

  .bow-mh-topbar-label {
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    font-weight: 600;
    color: var(--bow-muted);
  }

  /* Currency selector (first) */

  .bow-mh-currency {
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
    font-size: 0.8rem;
  }

  .bow-mh-currency label {
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    font-weight: 600;
    color: var(--bow-muted);
  }

  .bow-mh-currency select {
    border-radius: 999px;
    border: 1px solid var(--bow-border);
    padding: 0.25rem 0.75rem;
    font-size: 0.8rem;
    background: #ffffff;
    cursor: pointer;
  }

  /* Panels dropdown ‚Äì white bubbles */

  .bow-mh-panel-filter {
    display: flex;
    align-items: center;
    gap: 0.6rem;
    flex-wrap: wrap;
  }

  .bow-mh-panel-dropdown {
    position: relative;
  }

  .bow-pill-button {
    border-radius: 999px;
    border: 1px solid var(--bow-border);
    padding: 0.25rem 0.75rem;
    font-size: 0.8rem;
    background: #fff7ef;
    cursor: pointer;
    font-weight: 500;
    line-height: 1.2;
    transition:
      background 0.15s ease,
      border-color 0.15s ease,
      color 0.15s ease,
      transform 0.1s ease;
  }

  .bow-pill-button:hover {
    transform: translateY(-1px);
    border-color: #d4c5ae;
  }

  .bow-mh-panel-toggle-btn {
    background: #ffffff;
    border-radius: 999px;
    border: 1px solid var(--bow-border);
    padding-right: 0.9rem;
    display: inline-flex;
    align-items: center;
    gap: 0.35rem;
    color: var(--bow-accent);
  }

  .bow-mh-panel-toggle-btn .bow-mh-panel-summary {
    white-space: nowrap;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    font-size: 0.78rem;
  }

  .bow-mh-panel-caret {
    font-size: 0.75rem;
  }

  .bow-mh-panel-dropdown.is-open .bow-mh-panel-toggle-btn {
    border-color: var(--bow-accent);
    box-shadow: 0 0 0 1px rgba(139, 30, 63, 0.15);
  }

  .bow-mh-panel-menu {
    position: absolute;
    top: 110%;
    right: 0;
    min-width: 210px;
    padding: 0.5rem 0.6rem;
    border-radius: 16px;
    border: 1px solid var(--bow-border);
    background: #ffffff;
    box-shadow: 0 18px 40px rgba(15, 23, 42, 0.12);
    z-index: 20;
    display: none;
  }

  .bow-mh-panel-dropdown.is-open .bow-mh-panel-menu {
    display: block;
  }

  .bow-mh-panel-menu label {
    display: flex;
    align-items: center;
    gap: 0.4rem;
    font-size: 0.8rem;
    padding: 0.25rem 0.2rem;
    border-radius: 999px;
    cursor: pointer;
  }

  .bow-mh-panel-menu label:hover {
    background: #f9fafb;
  }

  .bow-mh-panel-menu input[type="checkbox"] {
    accent-color: var(--bow-accent);
  }

  .bow-mh-panel-chip {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0.1rem 0.55rem;
    border-radius: 999px;
    border: 1px solid var(--bow-border);
    background: #ffffff; /* white background bubbles */
    font-size: 0.75rem;
    font-weight: 500;
    color: var(--bow-accent);
    text-transform: uppercase;
    letter-spacing: 0.08em;
  }

  .bow-mh-panel-limit {
    font-size: 0.75rem;
    color: var(--bow-accent-soft);
    opacity: 0;
    transition: opacity 0.2s ease;
  }

  .bow-mh-panel-limit.is-visible {
    opacity: 1;
  }

  /* Horizon dropdown (third) */

  .bow-mh-horizon select {
    border-radius: 999px;
    border: 1px solid var(--bow-border);
    padding: 0.25rem 0.75rem;
    font-size: 0.8rem;
    background: #ffffff;
    cursor: pointer;
  }

  /* GRID LAYOUT -------------------------------------------------------- */

  .bow-mh-grid {
    display: grid;
    grid-template-columns: 1.3fr 1.3fr 1.8fr;
    grid-auto-rows: minmax(0, auto);
    gap: 1.2rem;
  }

  .bow-panel {
    background: var(--bow-card);
    border-radius: 22px;
    border: 1px solid var(--bow-border);
    padding: 0.9rem 1.1rem 1rem;
    box-shadow: 0 6px 16px rgba(148, 118, 94, 0.08);
    display: flex;
    flex-direction: column;
    min-width: 0;
  }

  .bow-panel.is-hidden {
    display: none;
  }

  .bow-panel--chart {
    grid-column: 3 / 4;
    grid-row: 1 / span 3;
  }

  @media (max-width: 980px) {
    .bow-mh-grid {
      grid-template-columns: minmax(0, 1fr);
    }
    .bow-panel--chart {
      grid-column: auto;
      grid-row: auto;
    }
  }

  .bow-panel-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 0.5rem;
    margin-bottom: 0.6rem;
  }

  .bow-panel-header h3 {
    margin: 0;
    font-size: 1rem;
  }

  .bow-panel-tag {
    font-size: 0.7rem;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    padding: 0.18rem 0.6rem;
    border-radius: 999px;
    border: 1px solid #e5ded1;
    background: #ffffff; /* white bubbles inside panels */
    color: var(--bow-accent);
    white-space: nowrap;
  }

  .bow-panel-tag--soft {
    background: #ffffff;
  }

  /* TABLES ------------------------------------------------------------- */

  .bow-mini-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.8rem;
  }

  .bow-mini-table thead th {
    font-size: 0.7rem;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    font-weight: 600;
    color: var(--bow-muted);
    padding: 0.25rem 0.15rem 0.35rem;
    border-bottom: 1px solid var(--bow-border-soft);
    text-align: left;
  }

  .bow-mini-table th:nth-child(n + 3),
  .bow-mini-table td:nth-child(n + 3) {
    text-align: right;
  }

  .bow-mini-table tbody td {
    padding: 0.28rem 0.15rem;
    border-bottom: 1px dotted rgba(210, 199, 183, 0.5);
    white-space: nowrap;
  }

  .bow-mini-table tbody tr:last-child td {
    border-bottom: none;
  }

  .bow-mini-table tbody tr {
    cursor: pointer;
    transition: background 0.12s ease, transform 0.06s ease;
  }

  .bow-mini-table tbody tr:hover {
    background: rgba(255, 255, 255, 0.7);
    transform: translateY(-1px);
  }

  .bow-col {
    text-align: right;
  }

  /* Sign-based colouring: positive green, negative red */

  .bow-col.is-pos {
    color: #15803d;
  }

  .bow-col.is-neg {
    color: #b91c1c;
  }

  /* frequency columns ‚Äì Level & YTD always visible; extra horizon toggled */
  .bow-col--ytd {
    display: table-cell;
  }

  .bow-col--1y,
  .bow-col--3y,
  .bow-col--5y {
    display: none;
  }

  .freq-1y .bow-col--1y,
  .freq-3y .bow-col--3y,
  .freq-5y .bow-col--5y {
    display: table-cell;
  }

  /* CHART -------------------------------------------------------------- */

  .bow-chart-toolbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.9rem;
    gap: 1rem;
  }

  .bow-chart-label {
    display: flex;
    flex-direction: column;
    gap: 0.15rem;
    font-size: 0.85rem;
  }

  .bow-chart-symbol {
    font-weight: 600;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: var(--bow-accent);
    font-size: 0.75rem;
  }

  .bow-chart-name {
    color: #374151;
  }

  .bow-chart-placeholder {
    position: relative;
    border-radius: 18px;
    padding: 1.1rem 1.3rem;
    background: radial-gradient(circle at 0% 0%, #f7f3ee 0, #fdfaf6 45%, #f8f1ea 100%);
    overflow: hidden;
    min-height: 210px;
  }

  .bow-chart-ghost-grid {
    position: absolute;
    inset: 12px 14px;
    background-image:
      linear-gradient(to right, rgba(209, 213, 219, 0.35) 1px, transparent 1px),
      linear-gradient(to bottom, rgba(209, 213, 219, 0.35) 1px, transparent 1px);
    background-size: 24px 24px;
    opacity: 0.35;
    border-radius: 14px;
  }

  .bow-chart-ghost-line {
    position: absolute;
    left: 7%;
    right: 7%;
    top: 26%;
    bottom: 28%;
    border-radius: 999px;
    background: linear-gradient(120deg, rgba(139, 30, 63, 0.06), rgba(139, 30, 63, 0.35));
    box-shadow: 0 0 0 1px rgba(139, 30, 63, 0.25);
    clip-path: polygon(
      0% 65%,
      18% 40%,
      32% 55%,
      47% 28%,
      62% 50%,
      80% 22%,
      100% 35%
    );
  }

  .bow-chart-ghost-dots {
    position: absolute;
    left: 7%;
    right: 7%;
    top: 26%;
    bottom: 28%;
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    padding-inline: 2%;
    pointer-events: none;
  }

  .bow-chart-ghost-dots span {
    width: 7px;
    height: 7px;
    border-radius: 999px;
    background: #ffffff;
    box-shadow: 0 0 0 2px rgba(139, 30, 63, 0.7);
  }

  .bow-chart-message {
    position: absolute;
    left: 1.6rem;
    bottom: 1.1rem;
    margin: 0;
    font-size: 0.82rem;
    color: var(--bow-muted);
    max-width: 360px;
  }

  .bow-markets-hub.has-selection .bow-chart-message {
    opacity: 0.7;
  }

  .flag {
    margin-right: 0.25rem;
  }

  @media (max-width: 720px) {
    .bow-mh-topbar {
      flex-direction: column;
      align-items: flex-start;
      border-radius: 18px;
    }
    .bow-chart-toolbar {
      flex-direction: column;
      align-items: flex-start;
    }
  }
</style>
</head><body><div class="bow-markets-hub freq-5y" data-currency="GBP" data-freq="5y">
<!-- HEADER -->
<div class="bow-mh-header">
<div>
<h2>BoW Markets Hub</h2>
<p class="bow-mh-subtitle">
        Snapshot of currencies, key markets, commodities, yields and diversifiers.
        Click on any asset to send it to the chart panel.
      </p>
</div>
</div>
<!-- TOP BAR: 1) Currency  2) Panels  3) Horizon -->
<div class="bow-mh-topbar">
<!-- 1) Currency -->
<div class="bow-mh-topbar-group">
<div class="bow-mh-currency">
<label for="bow-base-currency">Base</label>
<select id="bow-base-currency">
<option selected="" value="USD">USD</option>
<option value="EUR">EUR</option>
<option value="GBP">GBP</option>
</select>
</div>
</div>
<!-- 2) Panels dropdown -->
<div class="bow-mh-topbar-group bow-mh-panel-filter">
<span class="bow-mh-topbar-label">Panels</span>
<div class="bow-mh-panel-dropdown">
<button class="bow-pill-button bow-mh-panel-toggle-btn" type="button">
<span class="bow-mh-panel-summary">FX, EQUITIES, COMMODITIES, YIELDS</span>
<span class="bow-mh-panel-caret">‚ñæ</span>
</button>
<div class="bow-mh-panel-menu">
<label>
<input checked="" type="checkbox" value="currencies"/>
<span class="bow-mh-panel-chip">FX</span>
</label>
<label>
<input checked="" type="checkbox" value="equities"/>
<span class="bow-mh-panel-chip">Equities</span>
</label>
<label>
<input checked="" type="checkbox" value="commodities"/>
<span class="bow-mh-panel-chip">Commodities</span>
</label>
<label>
<input checked="" type="checkbox" value="yields"/>
<span class="bow-mh-panel-chip">Yields</span>
</label>
<label>
<input type="checkbox" value="diversifiers"/>
<span class="bow-mh-panel-chip">Diversifiers</span>
</label>
</div>
</div>
<div aria-live="polite" class="bow-mh-panel-limit"></div>
</div>
<!-- 3) Horizon dropdown -->
<div class="bow-mh-topbar-group bow-mh-horizon">
<span class="bow-mh-topbar-label">Extra horizon</span>
<select id="bow-horizon-select">
<option value="1y">1Y</option>
<option value="3y">3Y</option>
<option selected="" value="5y">5Y</option>
</select>
</div>
</div>
<!-- GRID -->
<div class="bow-mh-grid">
<!-- CURRENCIES -->
<section class="bow-panel bow-panel--currencies" data-panel-id="currencies">
<header class="bow-panel-header">
<h3>Currencies</h3>
<span class="bow-panel-tag">FX</span>
</header>
<table class="bow-mini-table">
<thead>
<tr>
<th>Pair</th>
<th>Level</th>
<th class="bow-col bow-col--ytd">YTD</th>
<th class="bow-col bow-col--1y">1Y</th>
<th class="bow-col bow-col--3y">3Y</th>
<th class="bow-col bow-col--5y">5Y</th>
</tr>
</thead>
<tbody><tr data-symbol="GBPUSD"><td>GBP / USD</td><td>1.317</td><td class="bow-col bow-col--ytd">+5.2%</td><td class="bow-col bow-col--1y">+4.3%</td><td class="bow-col bow-col--3y">+10.8%</td><td class="bow-col bow-col--5y">-0.2%</td></tr><tr data-symbol="GBPEUR"><td>GBP / EUR</td><td>1.133</td><td class="bow-col bow-col--ytd">-6.3%</td><td class="bow-col bow-col--1y">-5.4%</td><td class="bow-col bow-col--3y">-1.1%</td><td class="bow-col bow-col--5y">+1.8%</td></tr><tr data-symbol="GBPCHF"><td>GBP / CHF</td><td>1.045</td><td class="bow-col bow-col--ytd">-8.0%</td><td class="bow-col bow-col--1y">-6.7%</td><td class="bow-col bow-col--3y">-6.7%</td><td class="bow-col bow-col--5y">-13.2%</td></tr><tr data-symbol="GBPJPY"><td>GBP / JPY</td><td>203.500</td><td class="bow-col bow-col--ytd">+3.5%</td><td class="bow-col bow-col--1y">+4.5%</td><td class="bow-col bow-col--3y">+23.2%</td><td class="bow-col bow-col--5y">+47.5%</td></tr><tr data-symbol="GBPPLN"><td>GBP / PLN</td><td>4.782</td><td class="bow-col bow-col--ytd">-7.2%</td><td class="bow-col bow-col--1y">-8.0%</td><td class="bow-col bow-col--3y">-10.8%</td><td class="bow-col bow-col--5y">-4.4%</td></tr></tbody>
</table>
</section>
<!-- KEY MARKETS -->
<section class="bow-panel bow-panel--global-markets" data-panel-id="equities">
<header class="bow-panel-header">
<h3>Key Markets</h3>
<span class="bow-panel-tag">Equities</span>
</header>
<table class="bow-mini-table bow-mini-table--compact">
<thead>
<tr>
<th>Market</th>
<th>Level</th>
<th class="bow-col bow-col--ytd">YTD</th>
<th class="bow-col bow-col--1y">1Y</th>
<th class="bow-col bow-col--3y">3Y</th>
<th class="bow-col bow-col--5y">5Y</th>
</tr>
</thead>
<tbody><tr data-symbol="SWDA"><td>Developed Markets</td><td>9731.00</td><td class="bow-col bow-col--ytd">+12.5%</td><td class="bow-col bow-col--1y">+14.1%</td><td class="bow-col bow-col--3y">+52.9%</td><td class="bow-col bow-col--5y">+84.3%</td></tr><tr data-symbol="EMIM"><td>Emerging Markets</td><td>3408.00</td><td class="bow-col bow-col--ytd">+25.1%</td><td class="bow-col bow-col--1y">+25.6%</td><td class="bow-col bow-col--3y">+40.8%</td><td class="bow-col bow-col--5y">+35.3%</td></tr><tr data-symbol="CUKX"><td>UK Large Caps</td><td>19430.00</td><td class="bow-col bow-col--ytd">+22.5%</td><td class="bow-col bow-col--1y">+24.5%</td><td class="bow-col bow-col--3y">+46.6%</td><td class="bow-col bow-col--5y">+79.3%</td></tr><tr data-symbol="CSP1"><td>US Large Caps</td><td>54924.00</td><td class="bow-col bow-col--ytd">+9.5%</td><td class="bow-col bow-col--1y">+11.4%</td><td class="bow-col bow-col--3y">+57.3%</td><td class="bow-col bow-col--5y">+98.5%</td></tr><tr data-symbol="VWRP"><td>üê∂ Global Equities</td><td>126.88</td><td class="bow-col bow-col--ytd">+14.1%</td><td class="bow-col bow-col--1y">+15.7%</td><td class="bow-col bow-col--3y">+51.6%</td><td class="bow-col bow-col--5y">+76.5%</td></tr></tbody>
</table>
</section>
<!-- COMMODITIES -->
<section class="bow-panel bow-panel--commodities" data-panel-id="commodities">
<header class="bow-panel-header">
<h3>Commodities</h3>
<span class="bow-panel-tag">Real Assets</span>
</header>
<table class="bow-mini-table">
<thead>
<tr>
<th>Contract</th>
<th>Level</th>
<th class="bow-col bow-col--ytd">YTD</th>
<th class="bow-col bow-col--1y">1Y</th>
<th class="bow-col bow-col--3y">3Y</th>
<th class="bow-col bow-col--5y">5Y</th>
</tr>
</thead>
<tbody>
<tr data-symbol="CL1">
<td>Crude Oil (WTI)</td>
<td>59.83</td>
<td class="bow-col bow-col--ytd">+5.3%</td>
<td class="bow-col bow-col--1y">+9.8%</td>
<td class="bow-col bow-col--3y">+14.5%</td>
<td class="bow-col bow-col--5y">+18.0%</td>
</tr>
<tr data-symbol="CO1">
<td>Brent Crude</td>
<td>63.73</td>
<td class="bow-col bow-col--ytd">+4.9%</td>
<td class="bow-col bow-col--1y">+8.7%</td>
<td class="bow-col bow-col--3y">+13.2%</td>
<td class="bow-col bow-col--5y">+16.7%</td>
</tr>
<tr data-symbol="NG1">
<td>Natural Gas</td>
<td>4.33</td>
<td class="bow-col bow-col--ytd">-8.4%</td>
<td class="bow-col bow-col--1y">-10.1%</td>
<td class="bow-col bow-col--3y">-11.3%</td>
<td class="bow-col bow-col--5y">-12.1%</td>
</tr>
</tbody>
</table>
</section>
<!-- GLOBAL YIELDS -->
<section class="bow-panel bow-panel--yields" data-panel-id="yields">
<header class="bow-panel-header">
<h3>Global Yields</h3>
<span class="bow-panel-tag">Govt Bonds</span>
</header>
<table class="bow-mini-table">
<thead>
<tr>
<th>Country</th>
<th>Level (10Y)</th>
<th class="bow-col bow-col--ytd">YTD</th>
<th class="bow-col bow-col--1y">1Y</th>
<th class="bow-col bow-col--3y">3Y</th>
<th class="bow-col bow-col--5y">5Y</th>
</tr>
</thead>
<tbody><tr data-symbol="UK10Y"><td>üá¨üáß UK</td><td>4.58%</td><td class="bow-col bow-col--ytd">+0.01%</td><td class="bow-col bow-col--1y">+0.11%</td><td class="bow-col bow-col--3y">+1.29%</td><td class="bow-col bow-col--5y">+4.23%</td></tr><tr data-symbol="US10Y"><td>üá∫üá∏ US</td><td>4.15%</td><td class="bow-col bow-col--ytd">-0.43%</td><td class="bow-col bow-col--1y">-0.30%</td><td class="bow-col bow-col--3y">+0.37%</td><td class="bow-col bow-col--5y">+3.24%</td></tr><tr data-symbol="DE10Y"><td>üá©üá™ Germany</td><td>2.72%</td><td class="bow-col bow-col--ytd">+0.35%</td><td class="bow-col bow-col--1y">+0.37%</td><td class="bow-col bow-col--3y">+0.61%</td><td class="bow-col bow-col--5y">+3.27%</td></tr><tr data-symbol="FR10Y"><td>üá´üá∑ France</td><td>3.46%</td><td class="bow-col bow-col--ytd">+0.26%</td><td class="bow-col bow-col--1y">+0.38%</td><td class="bow-col bow-col--3y">+0.85%</td><td class="bow-col bow-col--5y">+3.77%</td></tr></tbody>
</table>
</section>
<!-- DIVERSIFIERS -->
<section class="bow-panel bow-panel--diversifiers is-hidden" data-panel-id="diversifiers">
<header class="bow-panel-header">
<h3>Diversifiers</h3>
<span class="bow-panel-tag">Alternatives</span>
</header>
<table class="bow-mini-table">
<thead>
<tr>
<th>Asset</th>
<th>Level</th>
<th class="bow-col bow-col--ytd">YTD</th>
<th class="bow-col bow-col--1y">1Y</th>
<th class="bow-col bow-col--3y">3Y</th>
<th class="bow-col bow-col--5y">5Y</th>
</tr>
</thead>
<tbody><tr data-symbol="CSH2"><td>Cash</td><td>120950.00</td><td class="bow-col bow-col--ytd">+4.1%</td><td class="bow-col bow-col--1y">+4.8%</td><td class="bow-col bow-col--3y">+15.6%</td><td class="bow-col bow-col--5y">+17.1%</td></tr><tr data-symbol="SGLN"><td>Gold</td><td>6048.00</td><td class="bow-col bow-col--ytd">+49.5%</td><td class="bow-col bow-col--1y">+53.2%</td><td class="bow-col bow-col--3y">+108.6%</td><td class="bow-col bow-col--5y">+119.1%</td></tr><tr data-symbol="BTCE"><td>Bitcoin</td><td>67.40</td><td class="bow-col bow-col--ytd">-15.8%</td><td class="bow-col bow-col--1y">-6.6%</td><td class="bow-col bow-col--3y">+350.1%</td><td class="bow-col bow-col--5y">+122.8%</td></tr><tr data-symbol="CMOP"><td>Commodities</td><td>2006.50</td><td class="bow-col bow-col--ytd">+9.2%</td><td class="bow-col bow-col--1y">+13.3%</td><td class="bow-col bow-col--3y">-3.7%</td><td class="bow-col bow-col--5y">+69.8%</td></tr></tbody>
</table>
</section>
<!-- CHART PANEL (no frequency controls ‚Äì uses top horizon) -->
<section class="bow-panel bow-panel--chart" data-currency="GBP">
<header class="bow-panel-header">
<h3>Chart</h3>
<span class="bow-panel-tag bow-panel-tag--soft">Click any asset</span>
</header>
<div class="bow-chart-toolbar">
<div class="bow-chart-label">
<span class="bow-chart-symbol">‚Äî</span>
<span class="bow-chart-name">No instrument selected</span>
</div>
</div>
<div class="bow-chart-placeholder">
<div class="bow-chart-ghost-grid"></div>
<div class="bow-chart-ghost-line"></div>
<div class="bow-chart-ghost-dots">
<span></span><span></span><span></span><span></span>
</div>
<p class="bow-chart-message">
          Select any instrument from the panels on the left or right to display its performance here.
        </p>
</div>
</section>
</div>
</div>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const hub = document.querySelector('.bow-markets-hub');
    if (!hub) return;

    /* ---------- Sign-based colouring for returns ---------- */
    function colorReturns() {
      hub.querySelectorAll('.bow-col').forEach(col => {
        const text = (col.textContent || '').trim();
        col.classList.remove('is-pos', 'is-neg');
        if (/^[+-]/.test(text)) {
          if (text.startsWith('+')) col.classList.add('is-pos');
          if (text.startsWith('-')) col.classList.add('is-neg');
        }
      });
    }

    colorReturns();

    /* ---------- HORIZON DROPDOWN (EXTRA HORIZON) ---------- */
    const horizonSelect = hub.querySelector('#bow-horizon-select');

    function setFrequency(freq) {
      const allowed = ['1y', '3y', '5y'];
      if (!allowed.includes(freq)) return;

      hub.classList.remove('freq-1y', 'freq-3y', 'freq-5y');
      hub.classList.add('freq-' + freq);
      hub.dataset.freq = freq;
    }

    if (horizonSelect) {
      horizonSelect.addEventListener('change', () => {
        setFrequency(horizonSelect.value);
      });
      setFrequency(horizonSelect.value || '5y');
    }

    /* ---------- PANEL SELECTOR (DROPDOWN, MAX 4) ---------- */
    const panelDropdown = hub.querySelector('.bow-mh-panel-dropdown');
    const panelMenu = hub.querySelector('.bow-mh-panel-menu');
    const panelSummary = hub.querySelector('.bow-mh-panel-summary');
    const panelLimit = hub.querySelector('.bow-mh-panel-limit');
    const panelCheckboxes = Array.from(panelMenu.querySelectorAll('input[type="checkbox"]'));
    const panels = Array.from(hub.querySelectorAll('.bow-panel[data-panel-id]'));
    const MAX_PANELS = 4;

    function updatePanelsFromCheckboxes() {
      const activeValues = panelCheckboxes
        .filter(cb => cb.checked)
        .map(cb => cb.value);

      panels.forEach(panel => {
        const id = panel.dataset.panelId;
        panel.classList.toggle('is-hidden', !activeValues.includes(id));
      });

      const labelMap = {
        currencies: 'FX',
        equities: 'EQUITIES',
        commodities: 'COMMODITIES',
        yields: 'YIELDS',
        diversifiers: 'DIVERSIFIERS'
      };
      const labels = activeValues.map(v => labelMap[v] || v.toUpperCase());
      panelSummary.textContent = labels.length ? labels.join(', ') : 'NONE';
    }

    function showPanelLimit() {
      if (!panelLimit) return;
      panelLimit.textContent = 'You can display up to 4 panels at once.';
      panelLimit.classList.add('is-visible');
      clearTimeout(showPanelLimit._timer);
      showPanelLimit._timer = setTimeout(() => {
        panelLimit.classList.remove('is-visible');
      }, 2000);
    }

    if (panelDropdown) {
      const toggleBtn = panelDropdown.querySelector('.bow-mh-panel-toggle-btn');

      toggleBtn.addEventListener('click', () => {
        panelDropdown.classList.toggle('is-open');
      });

      document.addEventListener('click', e => {
        if (!panelDropdown.contains(e.target)) {
          panelDropdown.classList.remove('is-open');
        }
      });

      panelCheckboxes.forEach(cb => {
        cb.addEventListener('change', () => {
          const activeCount = panelCheckboxes.filter(c => c.checked).length;
          if (activeCount > MAX_PANELS) {
            cb.checked = false;
            showPanelLimit();
            return;
          }
          updatePanelsFromCheckboxes();
        });
      });

      updatePanelsFromCheckboxes();
    }

    /* ---------- GLOBAL CURRENCY DROPDOWN ---------- */
    const chartPanel = hub.querySelector('.bow-panel--chart');
    const currencySelect = hub.querySelector('#bow-base-currency');

    if (currencySelect && chartPanel) {
      currencySelect.addEventListener('change', () => {
        const curr = currencySelect.value || 'USD';
        hub.dataset.currency = curr;
        chartPanel.dataset.currency = curr;
        // hook for real data conversion for tables & chart
      });

      const initial = currencySelect.value || 'USD';
      hub.dataset.currency = initial;
      chartPanel.dataset.currency = initial;
    }

    /* ---------- ROW CLICK -> UPDATE CHART HEADER ---------- */
    const chartSymbolEl = hub.querySelector('.bow-chart-symbol');
    const chartNameEl = hub.querySelector('.bow-chart-name');

    hub.querySelectorAll('.bow-mini-table tbody tr').forEach(row => {
      row.addEventListener('click', () => {
        const sym = row.dataset.symbol || '‚Äî';
        const firstCell = row.querySelector('td');
        const name = firstCell ? firstCell.textContent.trim() : 'Selected instrument';

        chartSymbolEl.textContent = sym;
        chartNameEl.textContent = name;
        hub.classList.add('has-selection');

        // hook for real chart data loading:
        // loadChart({ symbol: sym, name, currency: hub.dataset.currency, freq: hub.dataset.freq });
      });
    });
  });
</script>
</body></html>